<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Oracle - Dockimentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Oracle";
    var mkdocs_page_input_path = "bdd/oracle.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Dockimentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Database</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../cloudera/">Cloudera</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../hadoop/">Hadoop</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../mysql/">MySQL</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Oracle</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#spfile">Spfile</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#control-file">Control file</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#redolog">Redolog</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#data-base-file">Data base file</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#archive-log">Archive log</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#informations">Informations</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#diag-tunning">Diag Tunning</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#check">Check</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#bring-impdp">Bring impdp</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#global-prefs">Global Prefs</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#lsnrctl">LSNRCTL</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#odacli">ODACLI</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#oswbba">OSWBBA</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ressources">Ressources</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#processes">Processes</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#transactions">Transactions</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#verifier-les-parametres">Vérifier les paramètres</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#account">Account</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sqlplus">SQLPLUS</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#linesize">linesize</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#col">col</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#set-pause-on">set pause on</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#spool">spool</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#statspack">STATSPACK</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#analyser">Analyser</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#corriger">Corriger</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1-purge-statspack">1. Purge STATSPACK</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-move-table">2. Move table</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#3-rebuild-index">3. Rebuild Index</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#tnsname">TNSNAME</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#tablespace">Tablespace</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Cloud</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../cloud/cloud_infrastructure/">Cloud Infrastructure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../cloud/aws/">Amazon Web Services</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../cloud/gcp/">Google Cloud Platform</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../cloud/mz/">Microsoft Azure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../cloud/oci/">Oracle Cloud Infrastructure</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">DevOPS</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/Ansible/ansible/">Ansible</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/containers/terraform/">Terraform</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/containers/Docker-%26-Kubernetes/">Containers</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Code</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/code/Git/">Git</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/code/Perl/">Perl</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/code/Python/">Python</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Supervision</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../monitoring/centreon/">Centreon</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../monitoring/nagios/">Nagios</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../monitoring/elk/">ELK</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Hypervision</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../monitoring/pve/">Proxmox-VE</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../monitoring/kvm/">KVM</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../monitoring/esxi/">VMware ESXi</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Application</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../application/account_manager/">Account Manager</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../application/guacamole/">Guacamole</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Automation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../application/ui-path/">UI-Path</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../application/bareos/">Bareos</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../application/netbox/">Netbox</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Remote</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../application/vnc/">VNC</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Network</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../application/openvpn/">OpenVPN</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Operating System</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="#">Linux</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="#">System</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../os/linux/system/">System</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../os/linux/vol/">Volumes</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../os/linux/desktop-environement/">Desktop environement</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../os/linux/packages/">Packages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../os/linux/analyse/">Analyses</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../os/linux/regular-parsing/">Regular Parsing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Application</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../os/linux/vim/">VIM</a>
                </li>
    </ul>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Windaub</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../os/windows/account/">Account</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">System</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../os/windows/sys/">System</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../os/windows/boot/">boot</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../os/windows/dsk/">Disk</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Application & Features</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../os/windows/wsl/">WSL</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../os/windows/chrome/">Google Chrome</a>
                </li>
    </ul>
                </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../about/">About</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Dockimentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Database &raquo;</li>
        
      
    
    <li>Oracle</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="oracle">Oracle</h1>
<p>Here are somes Oracle tips &amp; tricks</p>
<h2 id="spfile">Spfile</h2>
<p>SPFILE (Fichier de paramètres persistant) est un fichier binaire recherché automatiquement au démarrage de l’instance.</p>
<p>Son nom par défaut est spfile<SID>.ora.</p>
<p>Il est situé dans $ORACLE_HOME/dbs/.</p>
<p>Le fichier SPFILE est recommandé par Oracle en raison de la possibilité de géré dynamiquement de nombreux paramètres d’initialisation. Il est modifié par le moteur Oracle.</p>
<p>PFILE (Fichier de paramètres statique) est un fichier texte recherché automatiquement au démarrage de l’instance en l’absence du fichier SPFILE.</p>
<p>Il est modifié manuellement par le DBA.</p>
<p>Son nom par défaut est : init<SID>.ora et il est situé dans $ORACLE_HOME/dbs.</p>
<p>Les modifications prennent effet qu’après le redémarrage de l’instance.</p>
<p>CRÉER UN SPFILE A PARTIR D’UN PFILE
Vous pouvez créer un fichier SPFILE à partir d’un fichier PFILE via la commande suivante (instance démarrée ou non) et ou le nom d’instance est DBA01 : </p>
<pre><code class="language-SQL">    CREATE SPFILE = ‘$ORACLE_HOME/dbs/spfileDBA01.ora’ FROM PFILE = ‘$ORACLE_HOME/dbs/initDBA01.ora‘
</code></pre>
<h2 id="control-file">Control file</h2>
<p>Le fichier de contrôle est un fichier binaire, il contient des informations sur la structure physique de la base. Il est créé pendant la création de la base et il est modifié en permanence.</p>
<p>Ce fichier doit être toujours disponible car il est consulté; et modifié fréquemment par le serveur oracle. Et il est indispensable pour la restauration de la base.</p>
<p>Pour afficher les noms des fichiers de contrôle on utilise :</p>
<pre><code class="language-SQL">    SHOW PARAMETER CONTROL_FILES
    SELECT VALUE FROM V$PARAMETER WHERE NAME='control_files';
</code></pre>
<h2 id="redolog">Redolog</h2>
<p>Les fichiers Redo Logs servent à enregistrer toutes les modifications commitées effectuées sur le base de données.</p>
<p>Ils servent à protéger la base de données dans le cas d’un échec d’instance.</p>
<p>En cas de restauration de la base de données, on utilise les redo logs pour ‘rejouer’ les modifications qui ont eu lieu, les transactions validées (commit à la fin de la transaction) sont enregistrées dans les fichiers de données Oracle et les transactions non validées, s’il y en a, sont effacées des fichiers de données.</p>
<h2 id="data-base-file">Data base file</h2>
<p>Les fichiers physiques d’une base Oracle permettent de stocker de manière persistante les données manipulées par Oracle.</p>
<h2 id="archive-log">Archive log</h2>
<p>Quand la base est en mode NOARCHIVELOG, l’archivage des fichiers redo est désactivé.</p>
<p>Le fichier de contrôle indique que les groupes des fichiers redo pleins ne sont plus nécessaires.</p>
<p>Dès qu’ils sont inactifs après un log switch, le groupe sera disponible pour une réutilisation par la LGWR . → (lgwr écrit toutes les entrées refaites qui ont été copiées dans le tampon depuis la dernière fois.)</p>
<p>Le mode NOARCHIVELOG protège la base contre une défaillance d’instance et non pas contre une défaillance media.</p>
<p>Seulement les modifications récentes dans la base, stockés dans les groupes de fichiers redo en ligne seront disponibles pour la restauration de la base.</p>
<p>En mode NOARCHIVELOG, on ne peut pas sauvegarder en ligne une tablespace. Pour restaurer une base en mode NOARCHIVELOG, on est obligé de faire une sauvegarde complète quand la base est fermée.</p>
<p>Quand la base est en mode ARCHIVELOG, l’archivage des fichiers redo est activé.</p>
<p>Le fichier de contrôle de la base signale que les groupes contenant des fichiers redo pleins ne peuvent pas être utilisés par le process LGWR tant que les groupes n’ont pas été archivés.</p>
<p>Vérifier s’il y a présence d’Archive log :</p>
<pre><code class="language-SQL">archive log list
</code></pre>
<p>Connaître la destination de chacune d’entre-elles :</p>
<pre><code class="language-SQL">show parameter log_archive_dest
</code></pre>
<p>Passer en mode d'archivage (//attention à ne pas omettre de monter seulement l'instance afin d'effectuer la manipulation. Celle-ci subira donc une <strong>relance</strong>//) :</p>
<pre><code class="language-SQL">ALTER DATABASE ARCHIVELOG;
</code></pre>
<h2 id="informations">Informations</h2>
<p>Connaître les informations et version de composant oracle :</p>
<pre><code class="language-SQL">odacli describe-component
</code></pre>
<p>Connaître le nom de la base sur laquelle on est connectée :</p>
<pre><code class="language-SQL">show parameter name
</code></pre>
<p>Ou encore pour soucis de sureté :</p>
<pre><code class="language-SQL">show parameter unique
</code></pre>
<p>Connaître le owner d’une table :</p>
<pre><code class="language-SQL">select disctinct owner from all_tables;
</code></pre>
<p>Savoir si la base tourne ou non en SQL :</p>
<pre><code class="language-SQL">SELECT INSTANCE_NAME, STATUS, DATABASE_STATUS FROM V$INSTANCE;
</code></pre>
<h2 id="diag-tunning">Diag Tunning</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Interpréter</td>
<td>Syntaxe : <code>CONTROL_MANAGEMENT_PACK_ACCESS = { NONE | DIAGNOSTIC | DIAGNOSTIC+TUNING}</code></td>
</tr>
<tr>
<td>Désactiver</td>
<td>Passon la mémoire tampon mais aussi le spfile à none</td>
</tr>
</tbody>
</table>
<p>En tant que sysdba :</p>
<pre><code class="language-SQL">ALTER SYSTEM SET CONTROL_MANAGEMENT_PACK_ACCESS=NONE SCOPE=BOTH;
</code></pre>
<h3 id="check">Check</h3>
<ul>
<li>Vérifier s’il est activé :</li>
</ul>
<pre><code class="language-SQL">show parameter control_management_pack_access
</code></pre>
<ul>
<li>Ou encore :</li>
</ul>
<pre><code class="language-SQL">select display_value from v$parameter where name = 'control_management_pack_access';
</code></pre>
<h2 id="bring-impdp">Bring impdp</h2>
<p>Réccupérer la vue sur un import en bacground :</p>
<pre><code class="language-SQL">impdp \&quot;/ as sysdba\&quot; ATTACH=&quot;SYS_IMPORT_FULL_01&quot;
</code></pre>
<h2 id="global-prefs">Global Prefs</h2>
<p>Get Global prefs :</p>
<pre><code class="language-SQL">SELECT DBMS_STATS.get_prefs('CONCURRENT') FROM dual;
</code></pre>
<table>
<thead>
<tr>
<th>Global Perfs State</th>
<th>SQL Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>True</td>
<td><code>DBMS_STATS.SET_GLOBAL_PREFS('CONCURRENT','TRUE');</code></td>
</tr>
<tr>
<td>False</td>
<td><code>DBMS_STATS.SET_GLOBAL_PREFS('CONCURRENT','FALSE');</code></td>
</tr>
</tbody>
</table>
<h2 id="lsnrctl">LSNRCTL</h2>
<p>L’utilitaire de contrôle d’écoute vous permet d’administrer des listeners.</p>
<p>Vous pouvez utiliser ses commandes pour exécuter des fonctions de gestion de base sur un ou plusieurs listeners.</p>
<p>En outre, vous pouvez afficher et modifier les paramètres.</p>
<p>Commandes possible :
- start<br />
- Stop
- Status
- Services
- Servacls
- Version
- Reload
- save_config
- Trace
- Spawn
- Quit
- Exit
- set<em>
- show</em></p>
<p>Effectuer un status du service listener : </p>
<p>Il se peut que celuic-ci ne se nomme pas LISTENER, il s’agit des paramètres pas défaut :</p>
<blockquote>
<p>lsnrctl status LISTENER</p>
</blockquote>
<h2 id="odacli">ODACLI</h2>
<p>Répertorier toutes les bases de données de l’appliance :</p>
<blockquote>
<p>odacli list-databases</p>
</blockquote>
<p>Afficher les détails de la base de données :</p>
<blockquote>
<p>odacli describe-database</p>
</blockquote>
<p>Créer une nouvelle base de données :</p>
<blockquote>
<p>odacli create-database</p>
</blockquote>
<p>Supprimer une base de données :</p>
<blockquote>
<p>odacli delete-database</p>
</blockquote>
<p>Réseau :
 - On trouvera les identifiants réseau :</p>
<pre><code>&gt; odacli list-network
</code></pre>
<ul>
<li>
<p>On y trouve tout les détails de ce réseau : ::</p>
<blockquote>
<p>odacli describe-ntwork -i $identifiants_réseau</p>
</blockquote>
</li>
</ul>
<h2 id="oswbba">OSWBBA</h2>
<pre><code class="language-JAVA">java -jar /opt/oracle/oak/oswbb/oswbba.jar -i /opt/oracle/oak/oswbb/archive -b Mar 18 00:00:00 2019 -e Mar 19 00:00:00 
</code></pre>
<h2 id="ressources">Ressources</h2>
<p>Afin de vérifier l’état du paramètre SESSIONS :</p>
<blockquote>
<p>SHOW parameter sessions</p>
</blockquote>
<h2 id="processes">Processes</h2>
<p>PROCESSES spécifie le nombre maximal de processus utilisateur du système d’exploitation pouvant se connecter simultanément à Oracle.</p>
<p>Sa valeur doit autoriser tous les processus d’arrière-plan tels que les verrous, les processus de file d’attente de travaux et les processus d’exécution parallèles.</p>
<p>Les valeurs par défaut des paramètres SESSIONS et TRANSACTIONS sont dérivées de ce paramètre.</p>
<p>Par conséquent, si vous modifiez la valeur de PROCESSES, vous devez déterminer si vous souhaitez ajuster les valeurs de ces paramètres dérivés.</p>
<p>Afin de vérifier l’état du paramètre PROCESSES :</p>
<blockquote>
<p>SHOW parameter processes</p>
</blockquote>
<p>Application du paramètre :</p>
<blockquote>
<p>ALTER SYSTEM SET processes=[VALUE AS INTEGER] SCOPE=SPFILE ;</p>
</blockquote>
<h2 id="transactions">Transactions</h2>
<p>TRANSACTIONS spécifie le nombre maximal de transactions simultanées.</p>
<p>Des valeurs plus élevées augmentent la taille du SGA et peuvent augmenter le nombre de segments de restauration alloués.</p>
<p>La valeur par défaut est supérieure à SESSIONS (et à son tour, PROCESSES) pour permettre les transactions récursives.</p>
<h3 id="verifier-les-parametres">Vérifier les paramètres</h3>
<p>Afin de vérifier l’état du paramètre TRANSACTIONS :</p>
<blockquote>
<p>SHOW parameter transactions</p>
</blockquote>
<p>Application du paramètre :</p>
<blockquote>
<p>ALTER SYSTEM SET transactions=[VALUE AS INTEGER] SCOPE=SPFILE ;</p>
</blockquote>
<p>:warning: Application des paramètres :</p>
<p>Afin d’appliquer des paramètres modifiés dans le <strong>spfile</strong>, un relance de l’instance sera requis : </p>
<pre><code class="language-SQL">shutdown immediate
startup
</code></pre>
<h2 id="account">Account</h2>
<p>Débloquer des compte vérouillé :</p>
<pre><code class="language-SQL">SQL&gt; conn / AS sysdba
Connected.
SQL&gt; ALTER USER $USER BY ******** account UNLOCK;
USER altered.
SQL&gt; ALTER USER $USER IDENTIFIED BY ******** account UNLOCK;
USER altered.
</code></pre>
<h2 id="sqlplus">SQLPLUS</h2>
<p>Paramétrage de l’interface sqlplus :</p>
<h3 id="linesize">linesize</h3>
<p>La longueur des lignes par défaut 80 caractères :</p>
<pre><code class="language-SQL">set linesize 200
</code></pre>
<h3 id="col">col</h3>
<p>Il défini un format de sortie pour une colonne particulière :</p>
<pre><code class="language-SQL">col table_name for a20
</code></pre>
<h3 id="set-pause-on">set pause on</h3>
<p>Permet une attente de RETURN pour faire défiler les lignes suivantes ( comme la commande more).</p>
<h3 id="spool">spool</h3>
<p>La sortie standard et d’erreur est redirigée dans le fichier indiqué dans la commande. La commande “spool off” ferme le fichier.</p>
<p>Utiliser la commande <code>SQL **start** or **@**</code> pour effectuer les script tel que .sql</p>
<h2 id="statspack">STATSPACK</h2>
<h3 id="analyser">Analyser</h3>
<p>Mise en forme du resultat :</p>
<pre><code class="language-SQL">col OWNER format a10
col SEGMENT_NAME format a60
col SEGMENT_TYPE format a15
set pagesize 1000

select owner,segment_name,segment_type,bytes/1024/1024 from dba_segments where tablespace_name = 'STATSPACK_TBS' and segment_type = 'TABLE' order by bytes desc;
</code></pre>
<h3 id="corriger">Corriger</h3>
<h4 id="1-purge-statspack">1. Purge STATSPACK</h4>
<p>Renseigner la plage d'id à purger :</p>
<pre><code class="language-SQL">DEFINE losnapid=1    -- low snap id
DEFINE hisnapid=2    -- high snap id
@?/rdbms/admin/sppurge.sql
</code></pre>
<h4 id="2-move-table">2. Move table</h4>
<p>How to move dba_segments :</p>
<pre><code class="language-SQL">    select 'alter table '||owner||'.'||segment_name||' move;' from dba_segments where tablespace_name = 'STATSPACK_TBS' and segment_type = 'TABLE' order by bytes desc;
</code></pre>
<h4 id="3-rebuild-index">3. Rebuild Index</h4>
<p>How to rebuild dba_indexes :</p>
<pre><code class="language-SQL">    select 'alter index '||owner||'.'||index_name||' rebuild;' from dba_indexes where status = 'UNUSABLE';
</code></pre>
<h2 id="tnsname">TNSNAME</h2>
<p>Comment la vérifier :</p>
<pre><code class="language-SQL">    [oracle@oda ~]# env | grep TNS
    TNS_ADMIN=/backup/TNS
</code></pre>
<p>Le fichier est donc dans <code>/backup/TNS/tnsname.ora</code>.</p>
<h3 id="configuration">Configuration:</h3>
<p>Voici un exemple de configuration :</p>
<pre><code class="language-SQL">(DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = ''iP de la machine'')(PORT = 1521))

    (CONNECT_DATA =
        (SERVER = DEDICATED)
        (SERVICE_NAME = ''Nom de la base'')  
    )

)
</code></pre>
<h2 id="tablespace">Tablespace</h2>
<p>Know the tablesapces size :</p>
<pre><code class="language-SQL">set line 1000
set pagesize 100
col &quot;Tablespace&quot; FOR a22
col &quot;Used MB&quot; FOR 99,999,999
col &quot;Free MB&quot; FOR 99,999,999
col &quot;Total MB&quot; FOR 99,999,999

SELECT df.tablespace_name &quot;Tablespace&quot;,
totalusedspace &quot;Used MB&quot;,
(df.totalspace - tu.totalusedspace) &quot;Free MB&quot;,
df.totalspace &quot;Total MB&quot;,
round(100 * ( (df.totalspace - tu.totalusedspace)/ df.totalspace))&quot;Pct. Free&quot;,
df.MAX_SIZE/1024/1024/1024 &quot;Max Size Go&quot;
FROM
(SELECT tablespace_name,
round(SUM(bytes) / 1048576) TotalSpace, 
sum(decode(AUTOEXTENSIBLE, 'YES', MAXBYTES, BYTES)) MAX_SIZE
FROM dba_data_files 
GROUP BY tablespace_name) df,
(SELECT round(SUM(bytes)/(1024*1024)) totalusedspace, tablespace_name
FROM dba_segments 
GROUP BY tablespace_name) tu
WHERE df.tablespace_name = tu.tablespace_name;
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../cloud/cloud_infrastructure/" class="btn btn-neutral float-right" title="Cloud Infrastructure">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../mysql/" class="btn btn-neutral" title="MySQL"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../mysql/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../cloud/cloud_infrastructure/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
